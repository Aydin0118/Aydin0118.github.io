<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>音乐播放器</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft Yahei", sans-serif;
        }
        body {
            background-color: #f5f5f5;
            padding: 20px;
        }
        .player-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .audio-player {
            width: 100%;
            margin: 20px 0;
        }
        .control-btn {
            padding: 8px 16px;
            margin: 0 5px;
            border: none;
            border-radius: 4px;
            background: #007bff;
            color: white;
            cursor: pointer;
            transition: background 0.3s;
        }
        .control-btn:hover {
            background: #0056b3;
        }
        .music-list {
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
        }
        .music-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background 0.2s;
        }
        .music-item:hover {
            background: #f8f9fa;
        }
        .music-item.active {
            background: #e9f5ff;
            color: #007bff;
            font-weight: bold;
        }
        .tips {
            color: #666;
            font-size: 12px;
            margin-top: 10px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="player-container">
        <h2>本地音乐播放器</h2>
        <!-- 音频核心组件 -->
        <audio id="audio" class="audio-player" controls>
            您的浏览器不支持音频播放
        </audio>
        
        <!-- 控制按钮 -->
        <div class="control-group">
            <button class="control-btn" id="prevBtn">上一曲</button>
            <button class="control-btn" id="playPauseBtn">播放</button>
            <button class="control-btn" id="nextBtn">下一曲</button>
        </div>
        
        <!-- 音乐列表 -->
        <div class="music-list" id="musicList">
            <!-- 动态生成音乐列表 -->
        </div>
        <div class="tips">提示：请确保music文件夹与本HTML文件同目录，且文件名与代码中一致</div>
    </div>

    <script>
        // ========== 第一步：完整的音乐文件列表（你可替换为自己的） ==========
        // 以下是包含你之前列出的所有歌曲 + 补充通用常见歌曲的完整列表
        const musicFiles = [
            // 你原有的歌曲（完整保留）
            "letting go.mp3",
            "一点.mp3",
            "丑八怪.mp3",
            "于是.mp3",
            "他不懂.mp3",
            "你还要我怎样.MP3",
            "光年之外.mp3",
            "刚刚好.mp3",
            "别让爱调落.mp3",
            "十年.mp3",
            "单车.mp3",
            "只为你着迷.mp3",
            "可不可以.mp3",
            "后来的我们没有在一起.mp3",
            "后来的我们没有走到一起.mP3",
            "哪些给天空的.mp3",
            "哪里都是你.mp3",
            "唯一.mp3",
            "嘉宾.mp3",
            "在你的身边.mp3",
            "坠楼.mp3",
            "多幸运.mp3",
            "多远都要在一起.mp3",
            "大海.mp3",
            "天外来物.mp3",
            "失控.mp3",
            "如果爱忘了.mp3",
            "姑娘别哭泣.mp3",
            
            // 可继续添加你music文件夹里的其他歌曲（示例补充）
            "七里香.mp3",
            "晴天.mp3",
            "告白气球.mp3",
            "成都.mp3",
            "小幸运.mp3",
            "起风了.mp3",
            "孤勇者.mp3",
            "稻香.mp3",
            "花海.mp3",
            "平凡之路.mp3",
            "南山南.mp3",
            "漠河舞厅.mp3",
            "如愿.mp3",
            "星辰大海.mp3",
            "勇气.mp3",
            "永不失联的爱.mp3",
            "爱如潮水.mp3",
            "认真的雪.mp3",
            "演员.mp3",
            "绅士.mp3"
        ];

        // ========== 第二步：核心功能代码（无需修改） ==========
        // 获取DOM元素
        const audio = document.getElementById('audio');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const musicList = document.getElementById('musicList');
        let currentIndex = 0; // 当前播放的歌曲索引

        // 初始化音乐列表（完整渲染所有歌曲）
        function initMusicList() {
            // 清空原有列表（避免重复渲染）
            musicList.innerHTML = '';
            
            // 遍历所有歌曲，生成列表项
            musicFiles.forEach((file, index) => {
                const item = document.createElement('div');
                item.className = 'music-item';
                item.dataset.index = index;
                // 提取文件名（去掉扩展名，忽略大小写）
                const musicName = file.replace(/\.(mp3|MP3|mP3)$/i, '');
                item.textContent = `${index + 1}. ${musicName}`;
                
                // 点击列表项播放对应歌曲
                item.addEventListener('click', () => {
                    currentIndex = index;
                    playMusic();
                });
                
                musicList.appendChild(item);
            });

            // 提示：如果列表为空，显示提示
            if (musicFiles.length === 0) {
                musicList.innerHTML = '<div style="text-align:center; padding:20px; color:#999;">暂无音乐文件，请在musicFiles数组中添加歌曲</div>';
            }
        }

        // 播放音乐函数（兼容路径和扩展名）
        function playMusic() {
            // 拼接music文件夹路径（确保路径正确）
            const musicPath = `music/${musicFiles[currentIndex]}`;
            audio.src = musicPath;
            
            // 播放音频（处理浏览器限制）
            audio.play().then(() => {
                updatePlayPauseBtn('暂停');
                updateActiveItem();
            }).catch(err => {
                console.error('播放失败原因：', err);
                alert(`播放失败！请检查：
1. ${musicFiles[currentIndex]} 是否在music文件夹中
2. 文件名（包括大小写）是否与代码中一致
3. 是否使用本地服务器运行（Chrome需Live Server）`);
            });
        }

        // 更新播放/暂停按钮文本
        function updatePlayPauseBtn(text) {
            playPauseBtn.textContent = text;
        }

        // 更新列表选中状态（高亮当前播放歌曲）
        function updateActiveItem() {
            document.querySelectorAll('.music-item').forEach(item => {
                item.classList.remove('active');
            });
            const activeItem = document.querySelector(`.music-item[data-index="${currentIndex}"]`);
            if (activeItem) activeItem.classList.add('active');
        }

        // 绑定按钮事件
        playPauseBtn.addEventListener('click', () => {
            if (audio.paused) {
                audio.play();
                updatePlayPauseBtn('暂停');
            } else {
                audio.pause();
                updatePlayPauseBtn('播放');
            }
        });

        prevBtn.addEventListener('click', () => {
            currentIndex = (currentIndex - 1 + musicFiles.length) % musicFiles.length;
            playMusic();
        });

        nextBtn.addEventListener('click', () => {
            currentIndex = (currentIndex + 1) % musicFiles.length;
            playMusic();
        });

        // 播放结束自动切下一曲
        audio.addEventListener('ended', () => {
            nextBtn.click();
        });

        // 初始化（页面加载完成后执行）
        window.onload = () => {
            initMusicList();
            // 默认加载第一首歌（不自动播放，避免浏览器限制）
            if (musicFiles.length > 0) {
                audio.src = `music/${musicFiles[0]}`;
                updateActiveItem();
            }
        };

        // ========== 第三步：快速导入本地music文件夹所有歌曲的方法（可选） ==========
        // 如果你不想手动写列表，可通过以下方式自动读取（需本地服务器）
        /* 
        // 注意：此方法需要启动本地服务器（如VSCode Live Server），且需要后端配合
        // 如需使用，删除上面的musicFiles数组，取消以下注释
        let musicFiles = [];
        // 读取music文件夹下的所有mp3文件
        fetch('music/')
            .then(response => response.text())
            .then(html => {
                // 解析目录页面，提取所有mp3文件名
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const links = doc.querySelectorAll('a');
                musicFiles = Array.from(links)
                    .map(link => link.textContent)
                    .filter(name => /\.mp3$/i.test(name));
                
                // 初始化列表
                initMusicList();
                if (musicFiles.length > 0) {
                    audio.src = `music/${musicFiles[0]}`;
                    updateActiveItem();
                }
            })
            .catch(err => {
                console.log('自动读取失败，使用手动列表：', err);
                // 备用列表（手动写的）
                musicFiles = [/* 你的手动列表 */ /*];
                initMusicList();
            });
        */
    </script>
</body>
</html>
